var TimeTrendChart=function(t){function e(n){if(r[n])return r[n].exports;var i=r[n]={exports:{},id:n,loaded:!1};return t[n].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var r={};return e.m=t,e.c=r,e.p="",e(0)}({0:function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=function(){function t(t,e){var r=[],n=!0,i=!1,a=void 0;try{for(var s,o=t[Symbol.iterator]();!(n=(s=o.next()).done)&&(r.push(s.value),!e||r.length!==e);n=!0);}catch(t){i=!0,a=t}finally{try{!n&&o.return&&o.return()}finally{if(i)throw a}}return r}return function(e,r){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();r(1);var u=r(5),c=(n(u),r(7)),h=n(c),f=(r(137),r(8)),p=r(6),v=.3,d=16,m="#4188bb",g="#e94f69",x="#139125",y="#CCCCCC",b="#ec9e4a",_=661,w=["20:00","0:00","9:00","13:30","15:30"],A=function(t){function e(t){var r=t.width,n=t.height,s=t.container,o=t.data,l=t.settlementPrice,u=t.high,c=t.low;i(this,e);var h=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return h.element=p.select(s),h.svg=h.element.append("svg"),h.svg.attr("width",r).attr("height",n),h.container=s,h.width=r,h.height=n,h.volHeight=n*v,h.baseHeight=n-h.volHeight-d,h.data=o,h.settlementPrice=l,h.high=u,h.low=c,h.render(),h.initTouchEvents(),h}return s(e,t),l(e,[{key:"render",value:function(){this.renderAxis(),this.renderArea(),this.renderVolumes()}},{key:"renderAxis",value:function(){this.createHorizontalAxis(),this.createVerticalAxis()}},{key:"initTouchEvents",value:function(){var t=this.svg,e=this.width,r=this.height,n=this.baseHeight,i=p.scaleLinear().domain([0,_]).range([0,e]),a=p.line().x(function(t){return t.x}).y(function(t){return t.y}),s=this,l=2,u=function(e){var r=t.selectAll(".guide-line").data(e);r.enter().append("path").attr("class","guide-line").merge(r).attr("d",a),r.exit().remove()},c=function(r,i){var a=t.selectAll(".tip-group").data(r);a.exit().remove(),a=a.enter().append("g").attr("class","tip-group").merge(a),a.selectAll(".tip-cell").data([i]).enter().append("rect").attr("class","tip-cell"),a.selectAll(".tip-text").data([i]).enter().append("text").attr("class","tip-text"),a.each(function(t,r){var a,s=p.select(this);0===r&&(a=s.select(".tip-text").text(i.date)),1===r&&(a=s.select(".tip-text").text(i.price));var o,u,c=a.node().getBBox();0===r?(o=t.x-(c.width+2*l)/2,u=t.y+c.height,o<0&&(o=0),o>e-c.width-2*l&&(o=e-c.width-2*l)):1===r&&(o=t.x+1,u=t.y+c.height/2-l,u<0&&(u=0),u>n-c.height/2&&(u=n-c.height/2)),s.attr("transform","translate("+o+", "+u+")"),a.attr("transform","translate("+l+", 0)");s.select("rect").attr("x",c.x).attr("y",c.y).attr("width",c.width+2*l).attr("height",c.height)})},f=function(){var t=p.touches(this),a=o(t,1),l=o(a[0],1),f=l[0],v=Math.floor(i.invert(f));if(!(v<0||v>=s.data.length)){var d=s.data[v];s.volumeLeftAxisElement.select(".tick text").text("成交量:"+(0,h.default)(d.volume));var m=[{x:f,y:0},{x:f,y:r}],g=s.areaScaleY(d.price),x=[{x:0,y:g},{x:e,y:g}];u([m,x]),c([{x:f,y:n},{x:0,y:g}],d),s.emit("change",d)}};t.on("touchstart",f).on("touchmove",f).on("touchend",function(){u([]),c([]),s.updateVolumesYAxis(),s.emit("change",s.data[s.data.length-1])})}},{key:"createHorizontalAxis",value:function(){var t=this.width,e=this.baseHeight,r=this.svg,n=[0,4*t/11,6.5*t/11,9*t/11,t],i=p.scaleOrdinal().domain(w).range(n);this.staticScale=i;var a=p.axisBottom(i).tickSize(0).tickPadding(6),s=r.append("g").attr("class","chart-axis").attr("transform","translate(0, "+e+")");s.call(a),s.selectAll(".tick text").attr("text-anchor","middle").attr("transform",function(t,e){return e===w.length-1?"translate(-16, 0)":0===e?"translate(15, 0)":void 0});var o=p.axisBottom(i).tickSize(e).tickFormat("");r.append("g").attr("class","chart-axis").attr("transform","translate(0, 0)").call(o)}},{key:"createScaleForAxisY",value:function(){var t=this.settlementPrice,e=this.baseHeight,r=this.low,n=this.high,i=0,a=0,s=0;s=n>t?n-t:t-n,a=r>t?r-t:t-r,i=s>a?s:a;var o=[],l=t+i,u=t,c=t-i;o=[c,u,l].map(function(t){return Number(t).toFixed(2)}),this.realMax=l,this.realMin=c;var h=e/(o.length-1),f=o.map(function(t,e){return h*e});f=f.reverse();var v=p.scaleOrdinal().domain(o).range(f);return v}},{key:"createVerticalAxis",value:function(){var t=this.svg,e=t.append("g").attr("class","chart-axis");this.leftAxisElement=e,this.updateYAxis();var r=this.baseHeight/4,n=p.scaleOrdinal().domain([0,1,2,3,4]).range([0,1*r,2*r,3*r,this.baseHeight]),i=p.axisLeft(n).tickSize(this.width).tickFormat("").ticks(4),a=t.append("g").attr("class","chart-axis").attr("transform","translate("+(this.width-1)+", 0)").call(i);a.selectAll(".tick line").attr("stroke-dasharray",function(t,e){if(1==e||3==e)return"10, 4"})}},{key:"updateYAxis",value:function(){var t=this.createScaleForAxisY(),e=p.axisRight(t).tickSize(0);return this.leftAxisElement.call(e),this.leftAxisElement.selectAll(".tick text").attr("transform",function(t,e,r){var n=0==e?-10:10;return"translate(0, "+n+")"}).attr("fill",function(t,e,r){return 0==e?g:e==r.length-1?x:"#777"}),t}},{key:"renderArea",value:function(){this.svg.append("g").attr("class","trend-area-wrap"),this.updateArea()}},{key:"renderVolumes",value:function(){this.volumeWrapper=this.svg.append("g").attr("class","volume-wrap"),this.volumeWrapper.attr("transform","translate(0, "+(this.baseHeight+d)+")"),this.volumeLeftAxisElement=this.volumeWrapper.append("g").attr("class","chart-axis"),this.updateVolumesYAxis();var t=p.axisTop(this.staticScale).tickSize(this.volHeight-21).tickFormat(""),e=(this.volumeWrapper.append("g").attr("transform","translate(0, "+(this.volHeight-1)+")").attr("class","chart-axis").call(t),p.axisBottom(this.staticScale).tickSize(0).tickFormat(""));this.volumeWrapper.append("g").attr("class","chart-axis").call(e);this.updateVolumes();var r=(p.max(this.data,function(t){return t.volume}),p.scaleOrdinal().domain([1,2,3]).range([0,20,this.volHeight])),n=p.axisLeft(r).tickSize(this.width);this.volumeWrapper.append("g").attr("class","chart-axis").attr("transform","translate("+(this.width-1)+", 0)").call(n)}},{key:"updateVolumes",value:function(){var t=this,e=0,r=p.max(this.data,function(t){return t.volume}),n=p.scaleLinear().domain([0,_]).range([0,this.width]),i=p.scaleLinear().domain([e,r]).range([this.volHeight,20]),a=this.data.map(function(e,r){var a=e.volume,s=n(r),o=i(a);return[{x:s,y:o},{x:s,y:t.volHeight}]}),s=this.volumeWrapper.selectAll(".vol").data(a),o=this.data.map(function(t){return t.price}),l=p.line().x(function(t){return t.x}).y(function(t){return t.y});s.enter().append("path").attr("class","vol").merge(s).attr("d",l).attr("stroke",function(t,e){return 0===e?y:o[e]>o[e-1]?g:x}),s.exit().remove()}},{key:"updateVolumesYAxis",value:function(){var t=p.max(this.data,function(t){return t.volume}),e=this.data.length>0?this.data[this.data.length-1].volume:0,r=p.scaleOrdinal().domain(["成交量:"+(0,h.default)(e),(0,h.default)(t),0]).range([0,20,this.volHeight]),n=p.axisRight(r).tickSize(0);this.volumeLeftAxisElement.call(n),this.volumeLeftAxisElement.selectAll(".tick text").attr("transform","translate(0, 10)").attr("fill",b)}},{key:"updateArea",value:function(){var t=this.baseHeight,e=(this.svg,this.realMin),r=this.realMax,t=this.baseHeight,n=(this.svg,this.width),i=this.data,a=p.scaleLinear().domain([0,_]).range([0,n]),s=p.scaleLinear().domain([e,r]).range([t,0]),o=this.svg.select(".trend-area-wrap"),l=p.line().x(function(t,e){return a(e)}).y(function(t,e){return s(t.price)}),u=p.area().x(function(t,e){return a(e)}).y0(function(t,e){return s(t.price)}).y1(t),c=o.selectAll(".trend-line").data([i]);c.exit().remove(),c.enter().append("path").attr("class","trend-line").merge(c).attr("d",l).attr("fill","none").attr("stroke",m);var h=o.selectAll(".trend-area").data([i]);h.exit().remove(),h.enter().append("path").attr("class","trend-area").merge(h).attr("d",u).attr("fill",m).attr("opacity","0.3"),this.areaScaleX=a,this.areaScaleY=s,this.updateAverage()}},{key:"updateAverage",value:function(){var t=(this.svg,this.areaScaleX),e=this.areaScaleY,r=p.line().x(function(e,r){return t(r)}).y(function(t,r){return e(t.average)}),n=this.svg.select(".trend-area-wrap"),i=n.selectAll(".ma").data([this.data]);i.exit().remove(),i.enter().append("path").attr("class","ma").merge(i).attr("d",r)}},{key:"update",value:function(t){this.data=t,this.updateArea(),this.updateYAxis(),this.updateVolumes(),this.updateVolumesYAxis()}}]),e}(f);t.exports=A},1:function(t,e,r){var n=r(2);"string"==typeof n&&(n=[[t.id,n,""]]);r(4)(n,{});n.locals&&(t.exports=n.locals)},2:function(t,e,r){e=t.exports=r(3)(),e.push([t.id,".chart-axis line,.chart-axis path{stroke:#d4d4d4}.guide-line{stroke:#555;shape-rendering:crispEdges}.tip-cell{stroke:#555;fill:#fff;shape-rendering:crispEdges}.tip-text{fill:#555;font-size:10px}.ma{stroke:#ec9917}.ma,.ma5{fill:none}.ma5{stroke:#508ce7}.ma10{fill:none;stroke:#ec9917}.ma20{fill:none;stroke:#f94636}.ma60{fill:none;stroke:#2baf2b}",""])},3:function(t,e){t.exports=function(){var t=[];return t.toString=function(){for(var t=[],e=0;e<this.length;e++){var r=this[e];r[2]?t.push("@media "+r[2]+"{"+r[1]+"}"):t.push(r[1])}return t.join("")},t.i=function(e,r){"string"==typeof e&&(e=[[null,e,""]]);for(var n={},i=0;i<this.length;i++){var a=this[i][0];"number"==typeof a&&(n[a]=!0)}for(i=0;i<e.length;i++){var s=e[i];"number"==typeof s[0]&&n[s[0]]||(r&&!s[2]?s[2]=r:r&&(s[2]="("+s[2]+") and ("+r+")"),t.push(s))}},t}},4:function(t,e,r){function n(t,e){for(var r=0;r<t.length;r++){var n=t[r],i=p[n.id];if(i){i.refs++;for(var a=0;a<i.parts.length;a++)i.parts[a](n.parts[a]);for(;a<n.parts.length;a++)i.parts.push(u(n.parts[a],e))}else{for(var s=[],a=0;a<n.parts.length;a++)s.push(u(n.parts[a],e));p[n.id]={id:n.id,refs:1,parts:s}}}}function i(t){for(var e=[],r={},n=0;n<t.length;n++){var i=t[n],a=i[0],s=i[1],o=i[2],l=i[3],u={css:s,media:o,sourceMap:l};r[a]?r[a].parts.push(u):e.push(r[a]={id:a,parts:[u]})}return e}function a(t,e){var r=m(),n=y[y.length-1];if("top"===t.insertAt)n?n.nextSibling?r.insertBefore(e,n.nextSibling):r.appendChild(e):r.insertBefore(e,r.firstChild),y.push(e);else{if("bottom"!==t.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");r.appendChild(e)}}function s(t){t.parentNode.removeChild(t);var e=y.indexOf(t);e>=0&&y.splice(e,1)}function o(t){var e=document.createElement("style");return e.type="text/css",a(t,e),e}function l(t){var e=document.createElement("link");return e.rel="stylesheet",a(t,e),e}function u(t,e){var r,n,i;if(e.singleton){var a=x++;r=g||(g=o(e)),n=c.bind(null,r,a,!1),i=c.bind(null,r,a,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(r=l(e),n=f.bind(null,r),i=function(){s(r),r.href&&URL.revokeObjectURL(r.href)}):(r=o(e),n=h.bind(null,r),i=function(){s(r)});return n(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;n(t=e)}else i()}}function c(t,e,r,n){var i=r?"":n.css;if(t.styleSheet)t.styleSheet.cssText=b(e,i);else{var a=document.createTextNode(i),s=t.childNodes;s[e]&&t.removeChild(s[e]),s.length?t.insertBefore(a,s[e]):t.appendChild(a)}}function h(t,e){var r=e.css,n=e.media;if(n&&t.setAttribute("media",n),t.styleSheet)t.styleSheet.cssText=r;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(r))}}function f(t,e){var r=e.css,n=e.sourceMap;n&&(r+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(n))))+" */");var i=new Blob([r],{type:"text/css"}),a=t.href;t.href=URL.createObjectURL(i),a&&URL.revokeObjectURL(a)}var p={},v=function(t){var e;return function(){return"undefined"==typeof e&&(e=t.apply(this,arguments)),e}},d=v(function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())}),m=v(function(){return document.head||document.getElementsByTagName("head")[0]}),g=null,x=0,y=[];t.exports=function(t,e){e=e||{},"undefined"==typeof e.singleton&&(e.singleton=d()),"undefined"==typeof e.insertAt&&(e.insertAt="bottom");var r=i(t);return n(r,e),function(t){for(var a=[],s=0;s<r.length;s++){var o=r[s],l=p[o.id];l.refs--,a.push(l)}if(t){var u=i(t);n(u,e)}for(var s=0;s<a.length;s++){var l=a[s];if(0===l.refs){for(var c=0;c<l.parts.length;c++)l.parts[c]();delete p[l.id]}}}};var b=function(){var t=[];return function(e,r){return t[e]=r,t.filter(Boolean).join("\n")}}()},5:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(6),i=function(t,e,r){for(var i=n.interpolateNumber(t,e),a=[],s=0;s<=r;s++)a.push(i(s/r));return a};e.default=i},6:function(t,e){t.exports=window.d3},7:function(t,e){"use strict";var r=function(){function t(t,e){var r=[],n=!0,i=!1,a=void 0;try{for(var s,o=t[Symbol.iterator]();!(n=(s=o.next()).done)&&(r.push(s.value),!e||r.length!==e);n=!0);}catch(t){i=!0,a=t}finally{try{!n&&o.return&&o.return()}finally{if(i)throw a}}return r}return function(e,r){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.exports=function(t){for(var e=[[1e4,"万"],[1e8,"亿"]],n=e.length-1;n>=0;n--){var i=r(e[n],2),a=i[0],s=i[1];if(t>a){var o=(t/a).toFixed(2);return o+s}}return t}},8:function(t,e){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function n(t){return"function"==typeof t}function i(t){return"number"==typeof t}function a(t){return"object"==typeof t&&null!==t}function s(t){return void 0===t}t.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(t){if(!i(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},r.prototype.emit=function(t){var e,r,i,o,l,u;if(this._events||(this._events={}),"error"===t&&(!this._events.error||a(this._events.error)&&!this._events.error.length)){if(e=arguments[1],e instanceof Error)throw e;var c=new Error('Uncaught, unspecified "error" event. ('+e+")");throw c.context=e,c}if(r=this._events[t],s(r))return!1;if(n(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:o=Array.prototype.slice.call(arguments,1),r.apply(this,o)}else if(a(r))for(o=Array.prototype.slice.call(arguments,1),u=r.slice(),i=u.length,l=0;l<i;l++)u[l].apply(this,o);return!0},r.prototype.addListener=function(t,e){var i;if(!n(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,n(e.listener)?e.listener:e),this._events[t]?a(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,a(this._events[t])&&!this._events[t].warned&&(i=s(this._maxListeners)?r.defaultMaxListeners:this._maxListeners,i&&i>0&&this._events[t].length>i&&(this._events[t].warned=!0,"function"==typeof console.trace)),this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(t,e){function r(){this.removeListener(t,r),i||(i=!0,e.apply(this,arguments))}if(!n(e))throw TypeError("listener must be a function");var i=!1;return r.listener=e,this.on(t,r),this},r.prototype.removeListener=function(t,e){var r,i,s,o;if(!n(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(r=this._events[t],s=r.length,i=-1,r===e||n(r.listener)&&r.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(a(r)){for(o=s;o-- >0;)if(r[o]===e||r[o].listener&&r[o].listener===e){i=o;break}if(i<0)return this;1===r.length?(r.length=0,delete this._events[t]):r.splice(i,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},r.prototype.removeAllListeners=function(t){var e,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(r=this._events[t],n(r))this.removeListener(t,r);else if(r)for(;r.length;)this.removeListener(t,r[r.length-1]);return delete this._events[t],this},r.prototype.listeners=function(t){var e;return e=this._events&&this._events[t]?n(this._events[t])?[this._events[t]]:this._events[t].slice():[]},r.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(n(e))return 1;if(e)return e.length}return 0},r.listenerCount=function(t,e){return t.listenerCount(e)}},137:function(t,e,r){var n=r(138);t.exports=function(t,e,r){function i(){var c=n()-l;c<e&&c>0?a=setTimeout(i,e-c):(a=null,r||(u=t.apply(o,s),a||(o=s=null)))}var a,s,o,l,u;return null==e&&(e=100),function(){o=this,s=arguments,l=n();var c=r&&!a;return a||(a=setTimeout(i,e)),c&&(u=t.apply(o,s),o=s=null),u}}},138:function(t,e){function r(){return(new Date).getTime()}t.exports=Date.now||r}});