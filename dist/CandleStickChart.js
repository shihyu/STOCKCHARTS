var CandleStickChart=function(t){function e(n){if(r[n])return r[n].exports;var i=r[n]={exports:{},id:n,loaded:!1};return t[n].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var r={};return e.m=t,e.c=r,e.p="",e(0)}([function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=function(){function t(t,e){var r=[],n=!0,i=!1,a=void 0;try{for(var s,o=t[Symbol.iterator]();!(n=(s=o.next()).done)&&(r.push(s.value),!e||r.length!==e);n=!0);}catch(t){i=!0,a=t}finally{try{!n&&o.return&&o.return()}finally{if(i)throw a}}return r}return function(e,r){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();r(1);var u=r(5),c=n(u),h=r(7),f=n(h),d=r(6),p=r(8),v=.3,m=16,g="#e94f69",x="#139125",y=function(t){return t.close>t.open?g:x},b=function(t){function e(t){var r=t.width,n=t.height,s=t.container,o=t.data;i(this,e);var l=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return l.element=d.select(s),l.svg=l.element.append("svg"),l.svg.attr("width",r).attr("height",n),l.container=s,l.width=r,l.height=n,l.volHeight=n*v,l.baseHeight=n-l.volHeight-m,l.data=o,l.render(),l.initTouchEvents(),l}return s(e,t),l(e,[{key:"render",value:function(){this.renderAxis(),this.renderCandleStick(),this.renderAverageLines(),this.renderVolumes()}},{key:"renderAverageLines",value:function(){for(var t=this.svg,e=this.areaScaleY,r=d.scaleLinear().domain([0,this.data.length-1]).range([0,this.width]),n=["ma5","ma10","ma20","ma60"],i=d.line().x(function(t,e){return r(e)}).y(function(t){return e(t)}),a=0;a<n.length;a++){var s=n[a],o=t.selectAll("."+s).data([this.data.map(function(t){return t[s]})]);o.enter().append("path").attr("class",s).merge(o).attr("d",i),o.exit().remove()}}},{key:"initTouchEvents",value:function(){var t=this.svg,e=this.width,r=this.height,n=this.baseHeight,i=this,a=d.line().x(function(t){return t.x}).y(function(t){return t.y}),s=function(e){var r=t.selectAll(".guide-line").data(e);r.enter().append("path").attr("class","guide-line").merge(r).attr("d",a),r.exit().remove()},l=2,u=function(r,i){var a=t.selectAll(".tip-group").data(r);a.exit().remove(),a=a.enter().append("g").attr("class","tip-group").merge(a),a.selectAll(".tip-cell").data([i]).enter().append("rect").attr("class","tip-cell"),a.selectAll(".tip-text").data([i]).enter().append("text").attr("class","tip-text"),a.each(function(t,r){var a,s=d.select(this);0===r&&(a=s.select(".tip-text").text(i.date)),1===r&&(a=s.select(".tip-text").text(i.close));var o,u,c=a.node().getBBox();0===r?(o=t.x-(c.width+2*l)/2,u=t.y+c.height,o<0&&(o=0),o>e-c.width-2*l&&(o=e-c.width-2*l)):1===r&&(o=t.x+1,u=t.y+c.height/2-l,u<0&&(u=0),u>n-c.height/2&&(u=n-c.height/2)),s.attr("transform","translate("+o+", "+u+")"),a.attr("transform","translate("+l+", 0)");s.select("rect").attr("x",c.x).attr("y",c.y).attr("width",c.width+2*l).attr("height",c.height)})},c=function(){var t=d.touches(this),a=o(t,1),l=o(a[0],1),c=l[0],h=i.barScale,p=h.step(),v=h.bandwidth(),m=Math.round(c/p);if(!(m<0||m>=i.data.length)){var g=i.data[m];c=h(m)+v/2;var x=[{x:c,y:0},{x:c,y:r}],y=i.areaScaleY(g.close),b=[{x:0,y:y},{x:e,y:y}],A=[x,b];s(A),u([{x:c,y:n},{x:0,y:y}],g),i.axisLeftElement.select(".tick text").text("VOL:"+(0,f.default)(g.volume)),i.emit("change",i.data[m])}};t.on("touchstart",c).on("touchmove",c).on("touchend",function(){s([]),u([],null),i.updateVolumeLeftAxis()})}},{key:"renderAxis",value:function(){this.createHorizontalAxis(),this.createVerticalAxis()}},{key:"createHorizontalAxis",value:function(){var t=this.width,e=this.baseHeight,r=this.svg;this.data,this.createBottomTickAxis(),this.bottomAxisElement=r.append("g").attr("class","chart-axis").attr("transform","translate(0, "+e+")");this.updateCandleAreaBottomAxis();var n=t/4,i=d.scaleOrdinal().domain([0,1,2,3,4]).range([0,1*n,2*n,3*n,t-1]),a=d.axisBottom(i).tickSize(e).tickFormat("");this.verticalGuideScale=i,r.append("g").attr("class","chart-axis").call(a).selectAll(".tick line").attr("stroke-dasharray",function(t,e){if(1==e||3==e)return"10, 4"})}},{key:"createVerticalAxis",value:function(){var t=this.svg,e=this.baseHeight,r=(this.data,this.width);this.leftAxisElement=t.append("g").attr("class","chart-axis");this.updateCandleAreaLeftAxis();var n=(0,c.default)(e,0,4),i=d.scaleOrdinal().domain(n).range(n),a=d.axisLeft(i).tickSize(r).tickFormat("");t.append("g").attr("class","chart-axis").attr("transform","translate("+(r-1)+", 0)").call(a).selectAll(".tick line").attr("stroke-dasharray",function(t,e){if(1==e||3==e)return"10, 4"})}},{key:"updateAxis",value:function(){this.updateCandleAreaBottomAxis(),this.updateCandleAreaLeftAxis(),this.updateVolumeLeftAxis()}},{key:"createLeftTickAxis",value:function(){var t=this.baseHeight,e=this.data,r=d.min(e,function(t){return t.low}),n=d.max(e,function(t){return t.high}),i=[r,n],a=[t,0],s=d.scaleOrdinal().domain(i).range(a),o=d.axisRight(s).tickSize(0);return o}},{key:"updateCandleAreaLeftAxis",value:function(){this.leftAxisElement.call(this.createLeftTickAxis()),this.leftAxisElement.selectAll(".tick text").attr("transform",function(t,e){return"translate(0, "+(0==e?-10:10)+")"}).attr("fill",function(t,e){return 1==e?g:x})}},{key:"createBottomTickAxis",value:function(){var t=this.width,e=this.data,r=e.length,n=[e[0].date,r>1?e[r-1].date:""],i=[0,t],a=d.scaleOrdinal().domain(n).range(i),s=d.axisBottom(a).tickSize(0).tickPadding(6);return s}},{key:"updateCandleAreaBottomAxis",value:function(){this.bottomAxisElement.call(this.createBottomTickAxis()),this.bottomAxisElement.selectAll(".tick text").attr("text-anchor",function(t,e){return 0==e?"start":"end"})}},{key:"renderCandleStick",value:function(){var t=this.svg,e=this.width,r=this.data,n=this.baseHeight,i=d.scaleBand().domain(r.map(function(t,e){return e})).range([0,e]).padding(.4),a=parseInt(i.bandwidth()),s=d.min(r,function(t){return t.low}),o=d.max(r,function(t){return t.high}),l=d.scaleLinear().domain([s,o]).range([n,10]);this.areaScaleY=l,this.barScale=i;var u=t.selectAll(".candle").data(r);u.enter().append("rect").attr("class","candle").merge(u).attr("x",function(t,e){return i(e)}).attr("y",function(t,e){return l(Math.max(t.open,t.close))}).attr("width",a).attr("height",function(t){var e=l(Math.min(t.open,t.close))-l(Math.max(t.open,t.close));return e<1&&(e=1),e}).attr("fill",y),u.exit().remove();var c=d.line().x(function(t){return t.x}).y(function(t){return t.y}),h=t.selectAll(".shadow").data(r);h.enter().append("path").attr("class","shadow").merge(h).attr("d",function(t,e){var r=i(e)+a/2,n=l(t.high),s=l(t.low);return c([{x:r,y:n},{x:r,y:s}])}).attr("stroke",y),h.exit().remove()}},{key:"updateVolumeLeftAxis",value:function(){var t=this.volHeight,e=this.data,r=d.max(e,function(t){return t.volume}),n=e.length>0?e[e.length-1].volume:0,i=d.scaleOrdinal().domain(["VOL:"+(0,f.default)(n),(0,f.default)(r),0]).range([0,20,t]),a=d.axisRight(i).tickSize(0);this.axisLeftElement.call(a),this.axisLeftElement.selectAll(".tick text").attr("transform",function(t,e){return"translate(0, "+(2==e?-10:10)+")"})}},{key:"renderVolumes",value:function(){var t=this.svg,e=this.baseHeight,r=this.volHeight,n=this.width,i=(this.data,t.append("g").attr("class","volume-wrap"));i.attr("transform","translate(0, "+(e+m)+")"),this.volumeWrapper=i,this.renderVolumeBars();this.axisLeftElement=i.append("g").attr("class","chart-axis");this.updateVolumeLeftAxis();var a=d.scaleOrdinal().domain([1,2,3]).range([0,19,r]);i.append("g").attr("class","chart-axis").attr("transform","translate("+(n-1)+", 0)").call(d.axisLeft(a).tickSize(n).tickFormat("")),i.append("g").attr("class","chart-axis").attr("transform","translate(0, "+(r-1)+")").call(d.axisTop(this.verticalGuideScale).tickSize(r-20).tickFormat(""))}},{key:"renderVolumeBars",value:function(){var t=this,e=(this.svg,this.baseHeight,this.volHeight),r=this.data,n=0,i=d.max(r,function(t){return t.volume}),a=d.scaleLinear().domain([n,i]).range([e,20]),s=this.volumeWrapper.selectAll(".volume").data(r),o=this.barScale.bandwidth();s.enter().append("rect").attr("class","volume").merge(s).attr("x",function(e,r){return t.barScale(r)}).attr("y",function(t,e){return a(t.volume)}).attr("width",o).attr("height",function(t,r){return e-a(t.volume)}).attr("fill",y),s.exit().remove()}},{key:"update",value:function(t){this.data=t,this.renderCandleStick(),this.renderAverageLines(),this.renderVolumeBars(),this.updateAxis()}}]),e}(p);t.exports=b},function(t,e,r){var n=r(2);"string"==typeof n&&(n=[[t.id,n,""]]);r(4)(n,{});n.locals&&(t.exports=n.locals)},function(t,e,r){e=t.exports=r(3)(),e.push([t.id,".chart-axis line,.chart-axis path{stroke:#d4d4d4}.guide-line{stroke:#555;shape-rendering:crispEdges}.tip-cell{stroke:#555;fill:#fff;shape-rendering:crispEdges}.tip-text{fill:#555;font-size:10px}.ma{stroke:#ec9917}.ma,.ma5{fill:none}.ma5{stroke:#508ce7}.ma10{fill:none;stroke:#ec9917}.ma20{fill:none;stroke:#f94636}.ma60{fill:none;stroke:#2baf2b}",""])},function(t,e){t.exports=function(){var t=[];return t.toString=function(){for(var t=[],e=0;e<this.length;e++){var r=this[e];r[2]?t.push("@media "+r[2]+"{"+r[1]+"}"):t.push(r[1])}return t.join("")},t.i=function(e,r){"string"==typeof e&&(e=[[null,e,""]]);for(var n={},i=0;i<this.length;i++){var a=this[i][0];"number"==typeof a&&(n[a]=!0)}for(i=0;i<e.length;i++){var s=e[i];"number"==typeof s[0]&&n[s[0]]||(r&&!s[2]?s[2]=r:r&&(s[2]="("+s[2]+") and ("+r+")"),t.push(s))}},t}},function(t,e,r){function n(t,e){for(var r=0;r<t.length;r++){var n=t[r],i=d[n.id];if(i){i.refs++;for(var a=0;a<i.parts.length;a++)i.parts[a](n.parts[a]);for(;a<n.parts.length;a++)i.parts.push(u(n.parts[a],e))}else{for(var s=[],a=0;a<n.parts.length;a++)s.push(u(n.parts[a],e));d[n.id]={id:n.id,refs:1,parts:s}}}}function i(t){for(var e=[],r={},n=0;n<t.length;n++){var i=t[n],a=i[0],s=i[1],o=i[2],l=i[3],u={css:s,media:o,sourceMap:l};r[a]?r[a].parts.push(u):e.push(r[a]={id:a,parts:[u]})}return e}function a(t,e){var r=m(),n=y[y.length-1];if("top"===t.insertAt)n?n.nextSibling?r.insertBefore(e,n.nextSibling):r.appendChild(e):r.insertBefore(e,r.firstChild),y.push(e);else{if("bottom"!==t.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");r.appendChild(e)}}function s(t){t.parentNode.removeChild(t);var e=y.indexOf(t);e>=0&&y.splice(e,1)}function o(t){var e=document.createElement("style");return e.type="text/css",a(t,e),e}function l(t){var e=document.createElement("link");return e.rel="stylesheet",a(t,e),e}function u(t,e){var r,n,i;if(e.singleton){var a=x++;r=g||(g=o(e)),n=c.bind(null,r,a,!1),i=c.bind(null,r,a,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(r=l(e),n=f.bind(null,r),i=function(){s(r),r.href&&URL.revokeObjectURL(r.href)}):(r=o(e),n=h.bind(null,r),i=function(){s(r)});return n(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;n(t=e)}else i()}}function c(t,e,r,n){var i=r?"":n.css;if(t.styleSheet)t.styleSheet.cssText=b(e,i);else{var a=document.createTextNode(i),s=t.childNodes;s[e]&&t.removeChild(s[e]),s.length?t.insertBefore(a,s[e]):t.appendChild(a)}}function h(t,e){var r=e.css,n=e.media;if(n&&t.setAttribute("media",n),t.styleSheet)t.styleSheet.cssText=r;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(r))}}function f(t,e){var r=e.css,n=e.sourceMap;n&&(r+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(n))))+" */");var i=new Blob([r],{type:"text/css"}),a=t.href;t.href=URL.createObjectURL(i),a&&URL.revokeObjectURL(a)}var d={},p=function(t){var e;return function(){return"undefined"==typeof e&&(e=t.apply(this,arguments)),e}},v=p(function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())}),m=p(function(){return document.head||document.getElementsByTagName("head")[0]}),g=null,x=0,y=[];t.exports=function(t,e){e=e||{},"undefined"==typeof e.singleton&&(e.singleton=v()),"undefined"==typeof e.insertAt&&(e.insertAt="bottom");var r=i(t);return n(r,e),function(t){for(var a=[],s=0;s<r.length;s++){var o=r[s],l=d[o.id];l.refs--,a.push(l)}if(t){var u=i(t);n(u,e)}for(var s=0;s<a.length;s++){var l=a[s];if(0===l.refs){for(var c=0;c<l.parts.length;c++)l.parts[c]();delete d[l.id]}}}};var b=function(){var t=[];return function(e,r){return t[e]=r,t.filter(Boolean).join("\n")}}()},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(6),i=function(t,e,r){for(var i=n.interpolateNumber(t,e),a=[],s=0;s<=r;s++)a.push(i(s/r));return a};e.default=i},function(t,e){t.exports=window.d3},function(t,e){"use strict";var r=function(){function t(t,e){var r=[],n=!0,i=!1,a=void 0;try{for(var s,o=t[Symbol.iterator]();!(n=(s=o.next()).done)&&(r.push(s.value),!e||r.length!==e);n=!0);}catch(t){i=!0,a=t}finally{try{!n&&o.return&&o.return()}finally{if(i)throw a}}return r}return function(e,r){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.exports=function(t){for(var e=[[1e4,"万"],[1e8,"亿"]],n=e.length-1;n>=0;n--){var i=r(e[n],2),a=i[0],s=i[1];if(t>a){var o=(t/a).toFixed(2);return o+s}}return t}},function(t,e){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function n(t){return"function"==typeof t}function i(t){return"number"==typeof t}function a(t){return"object"==typeof t&&null!==t}function s(t){return void 0===t}t.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(t){if(!i(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},r.prototype.emit=function(t){var e,r,i,o,l,u;if(this._events||(this._events={}),"error"===t&&(!this._events.error||a(this._events.error)&&!this._events.error.length)){if(e=arguments[1],e instanceof Error)throw e;var c=new Error('Uncaught, unspecified "error" event. ('+e+")");throw c.context=e,c}if(r=this._events[t],s(r))return!1;if(n(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:o=Array.prototype.slice.call(arguments,1),r.apply(this,o)}else if(a(r))for(o=Array.prototype.slice.call(arguments,1),u=r.slice(),i=u.length,l=0;l<i;l++)u[l].apply(this,o);return!0},r.prototype.addListener=function(t,e){var i;if(!n(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,n(e.listener)?e.listener:e),this._events[t]?a(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,a(this._events[t])&&!this._events[t].warned&&(i=s(this._maxListeners)?r.defaultMaxListeners:this._maxListeners,i&&i>0&&this._events[t].length>i&&(this._events[t].warned=!0,"function"==typeof console.trace)),this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(t,e){function r(){this.removeListener(t,r),i||(i=!0,e.apply(this,arguments))}if(!n(e))throw TypeError("listener must be a function");var i=!1;return r.listener=e,this.on(t,r),this},r.prototype.removeListener=function(t,e){var r,i,s,o;if(!n(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(r=this._events[t],s=r.length,i=-1,r===e||n(r.listener)&&r.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(a(r)){for(o=s;o-- >0;)if(r[o]===e||r[o].listener&&r[o].listener===e){i=o;break}if(i<0)return this;1===r.length?(r.length=0,delete this._events[t]):r.splice(i,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},r.prototype.removeAllListeners=function(t){var e,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(r=this._events[t],n(r))this.removeListener(t,r);else if(r)for(;r.length;)this.removeListener(t,r[r.length-1]);return delete this._events[t],this},r.prototype.listeners=function(t){var e;return e=this._events&&this._events[t]?n(this._events[t])?[this._events[t]]:this._events[t].slice():[]},r.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(n(e))return 1;if(e)return e.length}return 0},r.listenerCount=function(t,e){return t.listenerCount(e)}}]);